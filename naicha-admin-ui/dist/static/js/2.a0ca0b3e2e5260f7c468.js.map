{"version":3,"sources":["webpack:///./src/router/permissionTree.js","webpack:///src/components/system/manage/RoleIndex.vue","webpack:///./src/components/system/manage/RoleIndex.vue?ada6","webpack:///./src/components/system/manage/RoleIndex.vue","webpack:///./src/api/modules/system/role.js"],"names":["permissionTree","title","permission","children","RoleIndex","dialogVisible","data","formTitle","showSetPermissionDialog","roles","formData","name","description","rules","required","message","trigger","router_permissionTree","defaultProps","id","label","permissions","mounted","this","_getAllRoles","methods","_this","Object","role","then","result","toAdd","resetForm","edit","selectedRole","JSON","parse","stringify_default","handelConfirm","_this2","toSetPermissions","that","resetChecked","indexOf","keys","forEach","item","push","console","log","$refs","setCheckedKeys","setPermissions","_this3","getCheckedNodes","node","vo","roleId","$notify","success","delRoles","_this4","$confirm","catch","manage_RoleIndex","render","_vm","_h","$createElement","_c","_self","staticStyle","text-align","margin","attrs","size","type","round","on","click","_v","visible","update:visible","$event","ref","model","label-width","prop","style","width","placeholder","maxlength","value","callback","$$v","$set","expression","show-checkbox","node-key","props","default-expanded-keys","default-checked-keys","stripe","default-sort","order","max-height","sortable","scopedSlots","_u","key","fn","scope","row","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","request","url","method","user","roleIds","userIdAndPermissions","__WEBPACK_IMPORTED_MODULE_0__utils_axiosRequest_js__"],"mappings":"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","file":"static/js/2.a0ca0b3e2e5260f7c468.js","sourcesContent":["/**\r\n * 权限树 授权的时候使用 细粒度\r\n id: 'title',\r\n label: 'title',\r\n children: 'children'\r\n\r\n permission作为key\r\n */\r\nconst permissionTree = [\r\n    {\r\n        title: '应用管理',\r\n        permission: \"system:app\", // 仅仅是作为key控制下视图\r\n        children: [\r\n            {\r\n                title: '用户管理',\r\n                permission: 'system:app:user' // 仅仅是作为key控制下视图\r\n            },\r\n            {\r\n                title: '商品管理',\r\n                permission: 'system:app:goods',\r\n                children: [\r\n                    {\r\n                        title: '添加商品',\r\n                        permission: \"system:app:goods:add\" // TODO 真正可以添加到数据库的权限值, 对应到具体的后台接口权限\r\n                    },\r\n                    {\r\n                        title: '修改商品',\r\n                        permission: \"system:app:goods:update\"\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                title: '商品种类管理',\r\n                permission: 'system:app:goodsCategory'\r\n            },\r\n            {\r\n                title: '订单管理',\r\n                permission: 'system:app:orderInfo'\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        title: '系统管理',\r\n        permission: \"system:admin\",\r\n        children: [\r\n            {\r\n                title: '系统配置',\r\n                permission: 'system:admin:config'\r\n            },\r\n            {\r\n                title: '定时任务',\r\n                permission: \"system:admin:timingTask\"\r\n\r\n            },\r\n            {\r\n                title: '管理员管理',\r\n                permission: \"system:admin:sysUser\"\r\n            },\r\n            {\r\n                title: '角色管理',\r\n                permission: \"system:admin:role\"\r\n            }\r\n        ]\r\n    }\r\n\r\n]\r\n\r\nexport default permissionTree\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/permissionTree.js","<template>\r\n  <!--添加或新增角色弹窗-->\r\n  <div style=\"text-align: left; margin: 5px 10px\">\r\n    <el-button size=\"mini\"  type=\"primary\" @click=\"toAdd\" round>添加</el-button>\r\n    <el-dialog :title=formTitle :visible.sync=\"dialogVisible\">\r\n      <el-form ref=\"elForm\" :model=\"formData\" :rules=\"rules\" size=\"medium\" label-width=\"100px\">\r\n        <el-form-item label=\"角色名称\" prop=\"name\">\r\n          <el-input v-model=\"formData.name\" placeholder=\"请输入角色名称\" :maxlength=\"20\" :style=\"{width: '100%'}\">\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"描述\">\r\n          <el-input v-model=\"formData.description\" placeholder=\"请输入描述\" :style=\"{width: '100%'}\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button @click=\"resetForm\">重置</el-button>\r\n          <el-button type=\"primary\" @click=\"handelConfirm\">确定</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n\r\n    <!--角色授权对话框-->\r\n    <el-dialog title=\"角色授权\" :visible.sync=\"showSetPermissionDialog\">\r\n      <el-form>\r\n        <el-form-item>\r\n          <!--树形控件 配置角色菜单-->\r\n          <el-tree\r\n                  :data=\"permissionTree\"\r\n                  show-checkbox\r\n                  node-key=\"permission\"\r\n                  :props=\"defaultProps\"\r\n                  :default-expanded-keys=\"['system:app']\"\r\n                  :default-checked-keys=\"permissions\"\r\n                  ref=\"permissionTree\">\r\n          </el-tree>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button @click=\"resetChecked\">清空</el-button>\r\n          <el-button type=\"primary\" @click=\"setPermissions\">确定</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n\r\n\r\n    <!--角色列表-->\r\n    <div style=\"margin: 5px 0px;text-align: left;\">\r\n      <el-table :data=\"roles\" stripe\r\n                :default-sort=\"{prop: 'name', order: 'ascending'}\"\r\n                :max-height=\"700\">\r\n        <el-table-column prop=\"name\" label=\"角色名称\" sortable></el-table-column>\r\n        <el-table-column prop=\"description\" label=\"描述\"></el-table-column>\r\n        <el-table-column label=\"操作\" width=\"150\">\r\n          <template slot-scope=\"scope\">\r\n<!--            <el-button @click=\"toSetPermissions(scope.row)\" type=\"text\" size=\"mini\">授权</el-button>-->\r\n<!--            <el-button @click=\"edit(scope.row)\" type=\"text\" size=\"mini\">编辑</el-button>-->\r\n<!--            <el-button type=\"text\" size=\"mini\" @click=\"delRoles(scope.row.id)\">删除</el-button>-->\r\n\r\n            <el-button @click=\"toSetPermissions(scope.row)\" type=\"text\" size=\"small\" >授权</el-button>\r\n            <el-button @click=\"edit(scope.row)\" type=\"text\" size=\"small\"  >编辑</el-button>\r\n            <el-button @click=\"delRoles(scope.row.id)\" type=\"text\" size=\"mini\"   >删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {deleteRoles, getAllRoles, updateRole, updateRolePermission} from '../../../api/modules/system/role.js'\r\n  import {addRole, getPermissionsOfRole} from \"../../../api/modules/system/role\";\r\n  import permissionTree from \"../../../router/permissionTree.js\"\r\n\r\n  export default {\r\n    dialogVisible: false,\r\n    data() {\r\n      return {\r\n        formTitle: '添加角色',\r\n        dialogVisible: false,\r\n        showSetPermissionDialog: false, // 角色授权对话框\r\n        roles: [],\r\n        formData: {\r\n          name: \"\",\r\n          description: \"\",\r\n        },\r\n        rules: {\r\n          name: [{\r\n            required: true,\r\n            message: '请输入角色名称',\r\n            trigger: 'blur'\r\n          }],\r\n          description: [],\r\n        },\r\n        permissionTree: permissionTree,\r\n        defaultProps: { // 树形控件值映射规则\r\n          id: 'title', // 作为key\r\n          label: 'title',\r\n          children: 'children'\r\n        },\r\n        permissions: []\r\n      }\r\n    },\r\n    mounted() {\r\n      this._getAllRoles()\r\n    },\r\n    methods: {\r\n      _getAllRoles() { //\r\n        getAllRoles().then(result => {\r\n          this.roles = result.data\r\n        })\r\n      },\r\n      toAdd() {\r\n        this.dialogVisible = true;\r\n        this.resetForm()\r\n        this.formTitle = '添加角色';\r\n      },\r\n      edit(selectedRole) {\r\n        // 深拷贝一个对象 不然在表格显示的数据会受到印象\r\n        this.formData = JSON.parse(JSON.stringify(selectedRole));\r\n        this.dialogVisible = true\r\n        this.formTitle = '更新角色'\r\n      },\r\n      // 重置表单\r\n      resetForm() {\r\n        this.formData = {\r\n          name: \"\",\r\n          description: \"\"\r\n        };\r\n      },\r\n      // 更新角色信息\r\n      handelConfirm() {\r\n        this.dialogVisible = false;\r\n        if (this.formTitle === \"添加角色\") {\r\n          addRole(this.formData).then(() => {\r\n            this._getAllRoles();\r\n          })\r\n        } else {\r\n          updateRole(this.formData).then(() => {\r\n            this._getAllRoles();\r\n          })\r\n        }\r\n      },\r\n      // 打开角色授权对话框\r\n      toSetPermissions(selectedRole) {\r\n        let that = this;\r\n        that.resetChecked();\r\n        that.formData = JSON.parse(JSON.stringify(selectedRole));\r\n        that.showSetPermissionDialog = true;\r\n        that.formTitle = '更新角色';\r\n        getPermissionsOfRole(selectedRole.id).then(result => {\r\n          if(result.data.indexOf(\"*\") >= 0){ // 是超级管理员\r\n            let keys = [];\r\n            that.permissionTree.forEach(item => {\r\n              keys.push(item.permission);\r\n            })\r\n            that.permissions = keys;\r\n            console.log(keys)\r\n          }else {\r\n            that.permissions = result.data;\r\n          }\r\n        })\r\n      },\r\n      resetChecked() {\r\n        if(this.$refs['permissionTree'])\r\n          this.$refs['permissionTree'].setCheckedKeys([]);\r\n      },\r\n      setPermissions() {\r\n        this.showSetPermissionDialog = false;\r\n        let nodes = this.$refs.permissionTree.getCheckedNodes(false) // 获取被选中的节点 (是否只是叶子节点)\r\n        let permissions = [];\r\n        nodes.forEach(node => {\r\n          if (node.permission) {\r\n            permissions.push(node.permission);\r\n          }\r\n        })\r\n        let vo = {\r\n          roleId: this.formData.id,\r\n          permissions: permissions\r\n        }\r\n        console.log(\"[设置角色权限] \", vo);\r\n        updateRolePermission(vo).then(result => {\r\n          this.$notify.success('操作成功')\r\n        })\r\n      },\r\n      // 删除角色\r\n      delRoles(id) {\r\n        let that = this;\r\n        this.$confirm(\"提示\", \"删除角色\", {}).then(() => {\r\n          deleteRoles([id]).then(() => {\r\n            this.$notify.success('删除成功')\r\n            that._getAllRoles();\r\n          })\r\n        }).catch(() => {\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n</script>\r\n<style>\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/system/manage/RoleIndex.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"text-align\":\"left\",\"margin\":\"5px 10px\"}},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\",\"round\":\"\"},on:{\"click\":_vm.toAdd}},[_vm._v(\"添加\")]),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.formTitle,\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"elForm\",attrs:{\"model\":_vm.formData,\"rules\":_vm.rules,\"size\":\"medium\",\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"prop\":\"name\"}},[_c('el-input',{style:({width: '100%'}),attrs:{\"placeholder\":\"请输入角色名称\",\"maxlength\":20},model:{value:(_vm.formData.name),callback:function ($$v) {_vm.$set(_vm.formData, \"name\", $$v)},expression:\"formData.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"描述\"}},[_c('el-input',{style:({width: '100%'}),attrs:{\"placeholder\":\"请输入描述\"},model:{value:(_vm.formData.description),callback:function ($$v) {_vm.$set(_vm.formData, \"description\", $$v)},expression:\"formData.description\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{on:{\"click\":_vm.resetForm}},[_vm._v(\"重置\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handelConfirm}},[_vm._v(\"确定\")])],1)],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"角色授权\",\"visible\":_vm.showSetPermissionDialog},on:{\"update:visible\":function($event){_vm.showSetPermissionDialog=$event}}},[_c('el-form',[_c('el-form-item',[_c('el-tree',{ref:\"permissionTree\",attrs:{\"data\":_vm.permissionTree,\"show-checkbox\":\"\",\"node-key\":\"permission\",\"props\":_vm.defaultProps,\"default-expanded-keys\":['system:app'],\"default-checked-keys\":_vm.permissions}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{on:{\"click\":_vm.resetChecked}},[_vm._v(\"清空\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.setPermissions}},[_vm._v(\"确定\")])],1)],1)],1),_vm._v(\" \"),_c('div',{staticStyle:{\"margin\":\"5px 0px\",\"text-align\":\"left\"}},[_c('el-table',{attrs:{\"data\":_vm.roles,\"stripe\":\"\",\"default-sort\":{prop: 'name', order: 'ascending'},\"max-height\":700}},[_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"角色名称\",\"sortable\":\"\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"description\",\"label\":\"描述\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"text\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.toSetPermissions(scope.row)}}},[_vm._v(\"授权\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"text\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.edit(scope.row)}}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"text\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.delRoles(scope.row.id)}}},[_vm._v(\"删除\")])]}}])})],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-084c6c5a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/system/manage/RoleIndex.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-084c6c5a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./RoleIndex.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./RoleIndex.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./RoleIndex.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-084c6c5a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./RoleIndex.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/system/manage/RoleIndex.vue\n// module id = null\n// module chunks = ","import request from '@/utils/axiosRequest.js'\r\n\r\nexport function getAllRoles(){\r\n  return request({\r\n    url: \"/role/list\",\r\n    method: \"get\"\r\n  })\r\n}\r\n\r\n// 获取角色所有权限\r\nexport function getPermissionsOfRole(roleId){\r\n  return request({\r\n    url: \"/role/perms/\" + roleId,\r\n    method: \"get\"\r\n  })\r\n}\r\n\r\n// 添加角色\r\nexport function addRole(user) {\r\n  return request({\r\n    url: \"/role/\",\r\n    method: \"post\",\r\n    data: user\r\n  })\r\n}\r\n\r\n// 更新角色\r\nexport function updateRole(role) {\r\n  return request({\r\n    url: \"/role\",\r\n    method: \"put\",\r\n    data: role\r\n  })\r\n}\r\n\r\n// 批量删除角色\r\nexport function deleteRoles(roleIds) {\r\n  return request({\r\n    url: \"/role/batch\",\r\n    method: \"delete\",\r\n    data: roleIds\r\n  })\r\n}\r\n\r\n// 修改角色的权限\r\nexport function updateRolePermission(userIdAndPermissions){\r\n  return request({\r\n    url: \"/role/permission\",\r\n    method: \"put\",\r\n    data: userIdAndPermissions\r\n  })\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/modules/system/role.js"],"sourceRoot":""}