webpackJsonp([13],{HxfT:function(e,t){},IcnI:function(e,t,n){"use strict";var o=n("7+uW"),s=n("NYxO"),a=[{path:"/appAdmin",component:function(){return n.e(0).then(n.bind(null,"Cl3J"))},icon:"el-icon-s-management",title:"应用管理",name:"appAdmin",children:[{path:"/app/userAdmin",component:function(){return n.e(11).then(n.bind(null,"LOvt"))},icon:"el-icon-user-solid",title:"用户管理",name:"userAdmin",permission:"system:app:user"},{path:"/app/goodsAdmin",component:function(){return n.e(7).then(n.bind(null,"+Wdd"))},icon:"el-icon-s-operation",title:"商品管理",name:"goodsAdmin",permission:"system:app:goods"},{path:"/app/goodsCategoryAdmin",component:function(){return n.e(8).then(n.bind(null,"wa5V"))},icon:"el-icon-s-operation",title:"商品种类",name:"goodsCategoryAdmin",permission:"system:app:goodsCategory"},{path:"/app/orderAdmin",component:function(){return n.e(5).then(n.bind(null,"n4LD"))},icon:"el-icon-s-operation",title:"订单管理",name:"orderAdmin",permission:"system:app:orderInfo"},{path:"/app/orderHandler",component:function(){return n.e(6).then(n.bind(null,"pqWi"))},icon:"el-icon-s-operation",title:"订单处理",name:"orderHandler",permission:"system:app:orderInfo"}]},{path:"/systemManage",component:function(){return n.e(0).then(n.bind(null,"Cl3J"))},icon:"el-icon-s-grid",title:"系统管理",name:"systemManage",children:[{path:"/system/monitor/appConfig",component:function(){return n.e(10).then(n.bind(null,"V0O6"))},icon:"el-icon-setting",title:"系统配置",name:"appConfigSetting",permission:"system:admin:config"},{path:"/system/monitor/timedTask",component:function(){return n.e(9).then(n.bind(null,"1/i9"))},icon:"el-icon-video-camera-solid",title:"定时任务",name:"timingTaskAdmin",permission:"system:admin:timingTask"},{path:"/system/manage/user",component:function(){return n.e(4).then(n.bind(null,"DoSD"))},icon:"el-icon-s-custom",title:"系统用户",name:"sysUser",permission:"system:admin:sysUser"},{path:"/system/manage/role",component:function(){return n.e(2).then(n.bind(null,"Ys75"))},icon:"el-icon-s-check",title:"角色管理",name:"roleAdmin",permission:"system:admin:role"}]}],i=n("YaEn");var r={state:{systemMenus:[]},getters:{systemMenus:function(e){return e.systemMenus}},mutations:{setSystemMenus:function(e,t){e.systemMenus=t}},actions:{generateSystemMenus:function(e,t){var n=e.commit;if(t.includes("*"))n("setSystemMenus",a),i.a.addRoutes(a);else{var o=function e(t,n){var o=[];return t.forEach(function(t){t.children?(t.children=e(t.children,n),t.children&&t.children.length>0&&o.push(t)):t.permission?function(e,t){for(var n=0;n<e.length;n++)if(e[n].startsWith(t))return!0;return!1}(n,t.permission)&&o.push(t):o.push(t)}),o}(a,t);n("setSystemMenus",o),i.a.addRoutes(o)}}}},c=n("mvHQ"),u=n.n(c),d=n("PvMi"),l=(n("zL8q"),{state:{userInfo:null,permissions:[],token:null},getters:{userInfo:function(e){return e.userInfo},token:function(e){return e.token},permissions:function(e){return e.permissions}},mutations:{setToken:function(e,t){e.token=t}},actions:{loginByToken:function(e,t){var n=e.commit,o=e.state,s=e.dispatch;console.log("[通过本地缓存的令牌登录]",t),n("setToken",t),Object(d.d)(t).then(function(e){o.userInfo=e.data,n("setToken",e.data.token),window.localStorage.setItem("token",e.data.token),s("generateSystemMenus",e.data.permissions),i.a.push({redirect:!0,path:"/index"})}).catch(function(){window.localStorage.removeItem("token")})},login:function(e,t){var n=e.commit,o=e.state,s=e.dispatch;Object(d.c)(t).then(function(e){o.userInfo=e.data,n("setToken",e.data.token),window.localStorage.setItem("token",e.data.token),window.localStorage.setItem("loginUser",u()(t)),s("generateSystemMenus",e.data.permissions),i.a.push({redirect:!0,path:"/index"})})},logout:function(e){var t=e.commit,n=e.state;t("setToken",null),n.userInfo=null,window.localStorage.removeItem("token"),location.reload()}}}),m={state:{routeTags:[],currentTag:[]},getters:{routeTags:function(e){return e.routeTags},currentTag:function(e){return e.tag}},mutations:{updateRouteTags:function(e,t){var n=!1;e.routeTags.forEach(function(e){e.name!==t.name||(n=!0)}),n||(e.routeTags.push(t),e.routeTags.length>7&&e.routeTags.splice(0,1))},deleteTag:function(e,t){e.routeTags.splice(t,1)}},actions:{}};o.default.use(s.a);t.a=new s.a.Store({modules:{systemMenu:r,user:l,menuTag:m},state:{},getters:{},mutations:{}})},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),s=n("dca+");var a={name:"OrderMessage",data:function(){return{messageList:[]}},mounted:function(){this.getMessage()},methods:{voiceTips:function(e){new Audio("http://tts.baidu.com/text2audio?cuid=baiduid&lan=zh&ctp=1&pdt=12&tex="+("您有新的订单来了,"+e+",请注意查看")).play()},getMessage:function(){var e=this;setInterval(function(){e.getRecentMessage()},15e3)},getRecentMessage:function(){var e=this;Object(s.a)({url:"/message/resentOrderMessage",method:"get"}).then(function(t){t.data.length>e.messageList.length&&e.voiceTips(t.data[t.data.length-1].address),e.messageList=t.data}).catch(function(e){console.log(e.data)})},confirmReceiveMessage:function(e){var t=this;(function(e){return Object(s.a)({url:"/message/confirmReceiveOrderMessage/"+e,method:"delete"})})(e).then(function(e){t.$notify.success(e.data),t.getRecentMessage()}).catch(function(e){console.log(e.data)})}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.messageList&&e.messageList.length?n("el-card",{staticClass:"box-card"},[n("div",{staticStyle:{"font-size":"25px"}},[n("span",[e._v("您有新的订单来了,请注意查看")])]),e._v(" "),e._l(e.messageList,function(t){return n("div",{key:t.orderNo,staticStyle:{"font-size":"15px"}},[e._v("\n      订单号["+e._s(t.orderNo)+"] ["+e._s(t.address)+"]\n      "),n("el-button",{attrs:{size:"default",type:"text"},on:{click:function(n){return e.confirmReceiveMessage(t.orderNo)}}},[e._v("收到")]),e._v(" "),n("br")],1)})],2):e._e()],1)},staticRenderFns:[]};var r={name:"App",components:{OrderMessage:n("VU/8")(a,i,!1,function(e){n("huVw")},null,null).exports},data:function(){return{background:"bg-sky-blue"}},created:function(){var e=window.localStorage.getItem("background");e&&(console.log("上传选择的背景为: "+e),this.background=e)}},c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:this.background?this.background:"",attrs:{id:"app"}},[t("OrderMessage",{staticStyle:{position:"fixed","z-index":"1000"}}),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var u=n("VU/8")(r,c,!1,function(e){n("HxfT")},null,null).exports,d=n("IcnI"),l=n("YaEn"),m=n("zL8q"),p=n.n(m);n("tvR6");o.default.use(p.a),o.default.prototype.$loading=p.a.Loading.service,o.default.prototype.$msgbox=p.a.MessageBox,o.default.prototype.$alert=p.a.MessageBox.alert,o.default.prototype.$confirm=p.a.MessageBox.confirm,o.default.prototype.$notify=p.a.Notification,o.default.prototype.$message=p.a.Message,o.default.config.debug=!1,new o.default({router:l.a,store:d.a,render:function(e){return e(u)}}).$mount("#app")},PvMi:function(e,t,n){"use strict";t.a=function(){return Object(o.a)({url:"/auth/code",method:"get"})},t.c=function(e){return Object(o.a)({url:"/auth/login",method:"post",data:e})},t.d=function(e){return Object(o.a)({url:"/auth/loginByToken?token="+e,method:"post"})},t.e=function(e,t){return Object(o.a)({url:"/auth/password",method:"put",data:{oldPassword:e,newPassword:t}})},t.b=function(){return Object(o.a)({url:"/auth/userInfo",method:"get"})};var o=n("dca+")},YaEn:function(e,t,n){"use strict";var o=n("7+uW"),s=n("IcnI"),a=n("/ocq");o.default.use(a.a);var i=[{path:"/",redirect:"/login"},{path:"/login",component:function(e){return n.e(3).then(function(){var t=[n("NIJD")];e.apply(null,t)}.bind(this)).catch(n.oe)},name:"login"},{path:"/index",component:function(){return n.e(0).then(n.bind(null,"Cl3J"))},redirect:"/system/dashboard",name:"systemIndex",title:"首页",hidden:!0,children:[{path:"/system/dashboard",component:function(){return n.e(1).then(n.bind(null,"JDXa"))},name:"dashboard",title:"首页报表"}]}],r=new a.a({routes:i});r.beforeEach(function(e,t,n){s.a.getters.userInfo||s.a.getters.token||(e.path.startsWith("/login")?n():(console.log("还没有登录"),n("/login"))),n()});t.a=r},"dca+":function(e,t,n){"use strict";var o=n("//Fk"),s=n.n(o),a=n("mtWM"),i=n.n(a),r=n("IcnI"),c=n("zL8q");n.n(c);var u=i.a.create({baseURL:"http://xxl.today/naicha-admin-api"});u.interceptors.request.use(function(e){return function(){var e=c.Loading.service({lock:!0,text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.1)"});setTimeout(function(){e.close()},200)}(),e.headers.token=r.a.getters.token,e.headers["Content-Type"]="application/json;charset=UTF-8",e},function(e){return s.a.reject(e)}),u.interceptors.response.use(function(e){if(console.log("[请求api] ["+e.config.method+"] ",e.config.url,"[接口返回数据]",e.data),e.status<200||e.status>=400)return c.Notification.error("未知异常"),s.a.reject();var t=e.data;return 200===t.code?t:(10001===t.code?c.MessageBox.alert("未登录或登录已经过期，请重新登录",{confirmButtonText:"去登录",type:"error"}).then(function(){r.a.dispatch("logout").then(function(){location.reload()})}):10002===t.code?c.Notification.error("权限不足 错误码["+t.code+"]"):c.Notification.error(t.message+" [错误码"+t.code+"]"),s.a.reject())},function(){return c.Notification.error("服务器网络异常"),s.a.reject()}),t.a=u},huVw:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.b6dd664139776e55eae1.js.map